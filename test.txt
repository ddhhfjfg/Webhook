-- ===== CONFIG =====
local WEBHOOK_URL = "https://discord.com/api/webhooks/1455764986830917796/kLiCOM-Hjp7e_e0k86KXnj_RJokF2JmUDQbeIAEhKltpmClNaoLn_7tSvZ8JRwu2ET6m"
local SEND_INTERVAL = 60 -- 1 ‡∏ô‡∏≤‡∏ó‡∏µ
-- ==================

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local MarketplaceService = game:GetService("MarketplaceService")
local player = Players.LocalPlayer

-- ‡∏ï‡∏£‡∏ß‡∏à executor
local request = http_request or request or syn.request
if not request then
	warn("Executor ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö HTTP Request")
	return
end

-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏°‡∏û
local placeId = game.PlaceId
local placeName = "Unknown"

-- ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å Marketplace ‡∏Å‡πà‡∏≠‡∏ô
local success, result = pcall(function()
	return MarketplaceService:GetProductInfo(placeId)
end)

if success and result and result.Name then
	placeName = result.Name
else
	-- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏≤‡∏Å game.Name ‡πÅ‡∏ó‡∏ô
	placeName = game.Name
end

-- ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü
local joinTime = tick()

-- ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)
local function formatTime(sec)
	local h = math.floor(sec / 3600)
	local m = math.floor((sec % 3600) / 60)
	local s = math.floor(sec % 60)

	return string.format("%d ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á %d ‡∏ô‡∏≤‡∏ó‡∏µ %d ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ", h, m, s)
end

-- ‡∏™‡πà‡∏á webhook
local function sendWebhook()
	local playerCount = #Players:GetPlayers()
	local stayTime = formatTime(tick() - joinTime)

	local data = {
		embeds = {{
			title = "‚è±Ô∏è Server Status",
			color = 5793266,
			fields = {
				{
					name = "üë§ Player",
					value = player.Name.." ("..player.UserId..")",
					inline = false
				},
				{
					name = "üó∫Ô∏è Map Name",
					value = placeName,
					inline = false
				},
				{
					name = "üë• Players in Server",
					value = tostring(playerCount),
					inline = true
				},
				{
					name = "‚è±Ô∏è Time in Server",
					value = stayTime,
					inline = true
				},
				{
					name = "üÜî PlaceId",
					value = tostring(placeId),
					inline = true
				}
			},
			timestamp = DateTime.now():ToIsoDate()
		}}
	}

	request({
		Url = WEBHOOK_URL,
		Method = "POST",
		Headers = {
			["Content-Type"] = "application/json"
		},
		Body = HttpService:JSONEncode(data)
	})
end

-- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏π‡∏õ‡∏™‡πà‡∏á‡∏ó‡∏∏‡∏Å 1 ‡∏ô‡∏≤‡∏ó‡∏µ
task.spawn(function()
	while true do
		sendWebhook()
		task.wait(SEND_INTERVAL)
	end
end)



-- ===== CONFIG =====
local WEBHOOK_URL = "https://discord.com/api/webhooks/1455854294891761879/4lNwHZyodt-kXhb8l0_AAv5STWUb6yZPo8C9U-geD-pHzf3-lKwPMeF-knkN0IzA-YQ1"
-- ==================

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer

-- ‡∏ï‡∏£‡∏ß‡∏à executor
local request = http_request or request or syn.request
if not request then
	warn("Executor ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö HTTP Request")
	return
end

-- ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏≤‡∏¢
local deathCount = 0

-- ‡∏™‡πà‡∏á webhook
local function sendWebhook()
	local data = {
		embeds = {{
			title = "üíÄ Player Died",
			color = 15158332,
			fields = {
				{
					name = "üë§ Player",
					value = player.Name.." ("..player.UserId..")",
					inline = false
				},
				{
					name = "‚ò†Ô∏è Death Count",
					value = tostring(deathCount),
					inline = true
				},
				{
					name = "üéÆ Game",
					value = game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name,
					inline = false
				}
			},
			timestamp = DateTime.now():ToIsoDate()
		}}
	}

	request({
		Url = WEBHOOK_URL,
		Method = "POST",
		Headers = {
			["Content-Type"] = "application/json"
		},
		Body = HttpService:JSONEncode(data)
	})
end

-- ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏¢
local function hookCharacter(character)
	local humanoid = character:WaitForChild("Humanoid", 10)
	if not humanoid then return end

	humanoid.Died:Connect(function()
		deathCount += 1
		sendWebhook()
	end)
end

-- ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡πÅ‡∏£‡∏Å
if player.Character then
	hookCharacter(player.Character)
end

-- ‡πÄ‡∏Å‡∏¥‡∏î‡πÉ‡∏´‡∏°‡πà / ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏±‡∏ß
player.CharacterAdded:Connect(hookCharacter)
